<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Обращение в поддержку</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-VHS7zS6LZPbi2sY8e+G7B1QUwpsOSJyYwcmBHQYaWV7k/akdUSHh3D1ynjGduVdA" crossorigin="anonymous">
    <style>
        body { background: #f5f7fb; }
        .form-card { background: #fff; border-radius: 16px; box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08); padding: 2rem; }
        .chat-card { background: #fff; border-radius: 16px; box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08); display: flex; flex-direction: column; height: 520px; }
        .chat-history { flex: 1; overflow-y: auto; padding: 1rem; background: #f9fafc; }
        .chat-message { border-radius: 12px; padding: 0.75rem 1rem; margin-bottom: 0.75rem; max-width: 80%; word-break: break-word; }
        .chat-message.user { background: #e8f1ff; margin-left: auto; }
        .chat-message.support { background: #e9fbef; margin-right: auto; }
        .chat-footer { border-top: 1px solid #e5e7eb; padding: 0.75rem 1rem; background: #fff; }
    </style>
</head>
<body>
<div class="container py-5">
    <div class="text-center mb-4">
        <div class="badge rounded-pill text-bg-primary px-3 py-2" th:text="${channelName} ?: 'Обращение'">Канал</div>
        <h1 class="mt-3 mb-2">Создать обращение</h1>
        <p class="text-muted mb-0">Заполните форму и следите за ответом службы поддержки.</p>
    </div>
    <div class="row g-4">
        <div class="col-12 col-lg-6">
            <div class="form-card">
                <form id="publicForm" class="needs-validation" novalidate>
                    <div class="mb-3">
                        <label class="form-label">Имя</label>
                        <input type="text" class="form-control" name="clientName" placeholder="Как к вам обращаться?">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Контакт для связи</label>
                        <input type="text" class="form-control" name="clientContact" placeholder="Телефон, e-mail или мессенджер">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Опишите проблему</label>
                        <textarea class="form-control" name="message" rows="6" required></textarea>
                        <div class="invalid-feedback">Опишите проблему, чтобы мы могли помочь.</div>
                    </div>
                    <button class="btn btn-primary w-100" type="submit">Отправить</button>
                    <div class="alert alert-danger mt-3 d-none" role="alert" data-role="error"></div>
                    <div class="alert alert-success mt-3 d-none" role="alert" data-role="success"></div>
                </form>
            </div>
        </div>
        <div class="col-12 col-lg-6">
            <div class="chat-card">
                <div class="chat-history" data-role="history">
                    <div class="text-muted text-center mt-5" data-role="placeholder">Здесь появится история диалога.</div>
                </div>
                <div class="chat-footer">
                    <div class="small text-muted" data-role="status">Диалог не создан</div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-NZCbFf8gDuwZQzQ0jrISFRCGDpa2BkLomqKgJo0vvArkH5AO9M/dwZ0pniNXh9v0" crossorigin="anonymous"></script>
<script th:inline="javascript">
    window.PUBLIC_FORM_INITIAL = {
        channelRef: /*[[${channelRef}]]*/ 'demo',
        initialToken: /*[[${initialToken}]]*/ '',
        channelId: /*[[${channelId}]]*/ null
    };
</script>
<script th:src="@{/js/public-form.js}"></script>
</body>
</html>
