<!-- Unified sidebar fragment shared across all pages -->
<div xmlns:th="http://www.thymeleaf.org" th:fragment="navbar(active)">
    <div class="sidebar" id="app-sidebar">
        <div class="sidebar-header">
            <a class="brand" th:href="@{/}">
                <img th:src="@{/bender-icon.svg}" alt="–õ–æ–≥–æ—Ç–∏–ø Bender" class="brand-icon" loading="lazy" decoding="async"/>
                <span class="brand-name">Bender</span>
            </a>
            <div class="sidebar-actions">
                <button id="pinSidebarBtn" class="icon-btn" type="button" title="–ó–∞–∫—Ä–µ–ø–∏—Ç—å –ø–∞–Ω–µ–ª—å">
                    üìå
                </button>
                <button id="resetSidebarOrderBtn" class="icon-btn" type="button" title="–°–±—Ä–æ—Å–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤">
                    ‚Ü∫
                </button>
                <button id="editSidebarOrderBtn" class="icon-btn" type="button" title="–ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤">
                    ‚áÖ
                </button>
            </div>
        </div>

        <nav class="sidebar-nav" aria-label="–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è">
            <a class="nav-link" data-page-key="dialogs"
               th:classappend="${active}=='dialogs' ? ' active'"
               th:href="@{/}">
                <span class="icon" aria-hidden="true">üí¨</span>
                <span class="label">–î–∏–∞–ª–æ–≥–∏</span>
            </a>
            <a class="nav-link" data-page-key="analytics" th:if="${canViewAnalytics}"
               th:classappend="${active}=='analytics' ? ' active'"
               th:href="@{/analytics}">
                <span class="icon" aria-hidden="true">üìà</span>
                <span class="label">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span>
            </a>
            <a class="nav-link" data-page-key="knowledge" th:if="${canEditKnowledgeBase}"
               th:classappend="${active}=='knowledge' ? ' active'"
               th:href="@{/knowledge-base}">
                <span class="icon" aria-hidden="true">üìö</span>
                <span class="label">–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π</span>
            </a>
            <a class="nav-link" data-page-key="tasks" th:if="${canManageTasks}"
               th:classappend="${active}=='tasks' ? ' active'"
               th:href="@{/tasks}">
                <span class="icon" aria-hidden="true">‚úÖ</span>
                <span class="label">–ó–∞–¥–∞—á–∏</span>
            </a>
            <a class="nav-link" data-page-key="passports" th:if="${canViewPassports}"
               th:classappend="${active}=='passports' ? ' active'"
               th:href="@{/object-passports}">
                <span class="icon" aria-hidden="true">üóÇÔ∏è</span>
                <span class="label">–ü–∞—Å–ø–æ—Ä—Ç–∞ –æ–±—ä–µ–∫—Ç–æ–≤</span>
            </a>
            <a class="nav-link" data-page-key="channels" th:if="${canManageChannels}"
               th:classappend="${active}=='channels' ? ' active'"
               th:href="@{/channels}">
                <span class="icon" aria-hidden="true">üì°</span>
                <span class="label">–ö–∞–Ω–∞–ª—ã</span>
            </a>
            <a class="nav-link" data-page-key="users" th:if="${canManageUsers}"
               th:classappend="${active}=='users' ? ' active'"
               th:href="@{/users}">
                <span class="icon" aria-hidden="true">üë•</span>
                <span class="label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
            </a>
            <a class="nav-link" data-page-key="settings" th:if="${canViewSettings}"
               th:classappend="${active}=='settings' ? ' active'"
               th:href="@{/settings}">
                <span class="icon" aria-hidden="true">‚öôÔ∏è</span>
                <span class="label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </a>
            <a class="nav-link" data-page-key="public"
               th:classappend="${active}=='public' ? ' active'"
               th:href="@{/public/forms/demo}">
                <span class="icon" aria-hidden="true">üåê</span>
                <span class="label">–ü—É–±–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º—ã</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="sidebar-user-card" th:if="${#authentication?.name}">
                <div class="sidebar-user-avatar">
                    <img th:src="@{/bender-icon.svg}" alt="–ê–≤–∞—Ç–∞—Ä" loading="lazy" decoding="async"/>
                </div>
                <div class="sidebar-user-meta">
                    <span class="sidebar-user-name" th:text="${#authentication?.name}">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                    <span class="sidebar-user-username" th:text="${#authentication?.principal}"></span>
                </div>
            </div>
            <a class="sidebar-logout-btn" th:href="@{/logout}">
                <span class="icon" aria-hidden="true">üö™</span>
                <span class="label">–í—ã–π—Ç–∏</span>
            </a>
        </div>
    </div>

    <script th:src="@{/js/theme.js}"></script>
    <script th:src="@{/js/sidebar.js}"></script>
</div>
