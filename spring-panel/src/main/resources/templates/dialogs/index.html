<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="_csrf" th:content="${_csrf.token}" />
    <title>–î–∏–∞–ª–æ–≥–∏ ‚Äî iguana</title>
    <link rel="icon" type="image/svg+xml" th:href="@{/iguana-icon.svg}" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/sidebar.css}">
    <link rel="stylesheet" th:href="@{/css/app.css}">
    <script th:src="@{/js/common.js}"></script>
</head>
<body class="with-sidebar sidebar-pinned">
<div th:replace="~{fragments/navbar :: navbar('dialogs')}"></div>

<main class="main-content container-fluid py-4">
    <div class="d-flex flex-column flex-lg-row justify-content-between align-items-lg-center gap-3 mb-4">
        <div>
            <h1 class="h3 mb-1">–î–∏–∞–ª–æ–≥–∏</h1>
            <p class="text-muted mb-0">–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∏—Å—Ç–æ—Ä–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.</p>
        </div>
        <div class="d-flex flex-wrap gap-2 align-items-center">
            <input type="search" id="dialogQuickSearch" class="form-control form-control-sm" placeholder="–ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫" style="min-width: 220px;">
            <select class="form-select form-select-sm" id="dialogPageSize" style="min-width: 140px;">
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="50">50</option>
                <option value="100">100</option>
                <option value="all">–í—Å–µ</option>
            </select>
            <div class="btn-group" role="group" aria-label="–í–∏–¥ –¥–∏–∞–ª–æ–≥–æ–≤">
                <button class="btn btn-outline-secondary btn-sm active" type="button" data-dialog-view="all">–í—Å–µ</button>
                <button class="btn btn-outline-secondary btn-sm" type="button" data-dialog-view="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
                <button class="btn btn-outline-secondary btn-sm" type="button" data-dialog-view="new">–ù–æ–≤—ã–µ</button>
                <button class="btn btn-outline-secondary btn-sm" type="button" data-dialog-view="unassigned">–ë–µ–∑ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ</button>
                <button class="btn btn-outline-secondary btn-sm" type="button" data-dialog-view="overdue">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ</button>
            </div>
            <button class="btn btn-outline-primary btn-sm" id="dialogFiltersBtn" type="button">–§–∏–ª—å—Ç—Ä—ã</button>
            <button class="btn btn-outline-secondary btn-sm" id="dialogColumnsBtn" type="button">–ö–æ–ª–æ–Ω–∫–∏</button>
        </div>
    </div>

    <div class="row g-3 mb-4">
        <div class="col-12 col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="text-muted small">–í—Å–µ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏–π</div>
                    <div class="h4 mb-0" id="dialogsSummaryTotal" th:text="${summary != null ? summary.totalTickets : 0}">0</div>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="text-muted small">–í –æ–∂–∏–¥–∞–Ω–∏–∏</div>
                    <div class="h4 mb-0" id="dialogsSummaryPending" th:text="${summary != null ? summary.pendingTickets : 0}">0</div>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="text-muted small">–ó–∞–∫—Ä—ã—Ç–æ</div>
                    <div class="h4 mb-0" id="dialogsSummaryResolved" th:text="${summary != null ? summary.resolvedTickets : 0}">0</div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow-sm">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover align-middle dialog-table" id="dialogsTable">
                    <thead>
                    <tr>
                        <th data-column-key="ticket">‚Ññ –æ–±—Ä–∞—â–µ–Ω–∏—è</th>
                        <th data-column-key="client">–ö–ª–∏–µ–Ω—Ç</th>
                        <th data-column-key="status">–°—Ç–∞—Ç—É—Å</th>
                        <th data-column-key="channel">–ö–∞–Ω–∞–ª</th>
                        <th data-column-key="business">–ë–∏–∑–Ω–µ—Å</th>
                        <th data-column-key="problem">–ü—Ä–æ–±–ª–µ–º–∞</th>
                        <th data-column-key="location">–õ–æ–∫–∞—Ü–∏—è</th>
                        <th data-column-key="categories">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</th>
                        <th data-column-key="responsible">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π</th>
                        <th data-column-key="created">–î–∞—Ç–∞</th>
                        <th data-column-key="sla">SLA</th>
                        <th data-column-key="actions">–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:if="${#lists.isEmpty(dialogs)}">
                        <td colspan="12" class="text-center text-muted py-4">–î–∏–∞–ª–æ–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td>
                    </tr>
                    <tr th:each="dialog : ${dialogs}"
                        th:data-ticket-id="${dialog.ticketId}"
                        th:data-client="${dialog.displayClientName()}"
                        th:data-client-status="${dialog.clientStatusLabel()}"
                        th:data-user-id="${dialog.userId()}"
                        th:data-channel-id="${dialog.channelId()}"
                        th:data-channel="${dialog.channelLabel()}"
                        th:data-business="${dialog.businessLabel()}"
                        th:data-problem="${dialog.problemSafe()}"
                        th:data-status="${dialog.statusLabel()}"
                        th:data-status-raw="${dialog.status()}"
                        th:data-status-key="${dialog.statusKey()}"
                        th:data-location="${dialog.location()}"
                        th:data-categories="${dialog.categoriesSafe()}"
                        th:data-responsible="${dialog.responsible()}"
                        th:data-created-at="${dialog.createdAt()}"
                        th:data-unread="${dialog.unreadCount()}"
                        th:data-rating="${dialog.rating()}"
                        th:data-request-number="${dialog.requestNumber()}"
                        th:data-last-message-timestamp="${dialog.lastMessageTimestamp()}">
                        <td th:text="${dialog.displayTicketNumber()}">‚Äî</td>
                        <td>
                            <div class="d-flex align-items-center gap-2">
                                <div class="dialog-avatar"
                                     th:attr="data-avatar-user-id=${dialog.userId}, data-avatar-name=${dialog.displayClientName()}">
                                    <img class="dialog-avatar-img d-none" alt="–ê–≤–∞—Ç–∞—Ä –∫–ª–∏–µ–Ω—Ç–∞" data-avatar-img>
                                    <span class="avatar-circle" data-avatar-initial th:text="${dialog.avatarInitial()}">‚Äî</span>
                                </div>
                                <div>
                                    <div class="fw-semibold" th:text="${dialog.displayClientName()}">–ö–ª–∏–µ–Ω—Ç</div>
                                    <div class="small text-muted" th:text="${dialog.clientStatusLabel()}">—Å—Ç–∞—Ç—É—Å</div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="d-flex align-items-center gap-2">
                                <span class="badge rounded-pill" th:classappend="${dialog.statusClass()}" th:text="${dialog.statusLabel()}">–û—Ç–∫—Ä—ã—Ç</span>
                                <span class="badge text-bg-danger dialog-unread-count"
                                      th:classappend="${dialog.unreadCount() != null and dialog.unreadCount() > 0} ? '' : ' d-none'"
                                      th:text="${dialog.unreadCount()}">0</span>
                            </div>
                            <div class="small text-warning" th:if="${dialog.ratingStars() != ''}" th:text="${dialog.ratingStars()}">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                        </td>
                        <td th:text="${dialog.channelLabel()}">‚Äî</td>
                        <td class="dialog-business-cell" th:data-business="${dialog.businessLabel()}">
                            <div class="dialog-business-pill">
                                <span class="dialog-business-icon d-none" aria-hidden="true"></span>
                                <span class="dialog-business-text" th:text="${dialog.businessLabel()}">‚Äî</span>
                            </div>
                        </td>
                        <td class="text-truncate" style="max-width: 260px;" th:text="${dialog.problemSafe()}">‚Äî</td>
                        <td th:text="${dialog.location()} ?: '‚Äî'">‚Äî</td>
                        <td th:text="${dialog.categoriesSafe()}">‚Äî</td>
                        <td th:text="${dialog.responsible()} ?: '‚Äî'">‚Äî</td>
                        <td>
                            <div class="small text-muted" th:text="${dialog.createdDateSafe()}">‚Äî</div>
                            <div class="small" th:text="${dialog.createdTimeSafe()}">‚Äî</div>
                        </td>
                        <td class="dialog-sla-cell">
                            <span class="badge rounded-pill dialog-sla-badge">‚Äî</span>
                        </td>
                        <td class="dialog-actions">
                            <a href="#" class="btn btn-sm btn-outline-primary dialog-open-btn" th:data-ticket-id="${dialog.ticketId}">–û—Ç–∫—Ä—ã—Ç—å</a>
                            <button type="button" class="btn btn-sm btn-outline-success dialog-take-btn"
                                    th:data-ticket-id="${dialog.ticketId}"
                                    th:classappend="${dialog.responsible() != null and !#strings.isEmpty(dialog.responsible())} ? ' d-none' : ''">–í–∑—è—Ç—å</button>
                            <a th:href="@{/tasks}" class="btn btn-sm btn-outline-secondary dialog-task-btn"
                               th:data-ticket-id="${dialog.ticketId}"
                               th:data-client="${dialog.displayClientName()}">–ó–∞–¥–∞—á–∞</a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</main>

<div class="modal fade" id="dialogFiltersModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–§–∏–ª—å—Ç—Ä—ã</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
            </div>
            <div class="modal-body">
                <form id="dialogFiltersForm">
                    <div class="mb-3">
                        <label class="form-label" for="dialogFilterSearch">–ü–æ–∏—Å–∫</label>
                        <input type="text" class="form-control" id="dialogFilterSearch" name="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–ª–∏–µ–Ω—Ç—É, –ø—Ä–æ–±–ª–µ–º–µ –∏–ª–∏ ID">
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="dialogFilterStatus">–°—Ç–∞—Ç—É—Å</label>
                        <select class="form-select" id="dialogFilterStatus" name="status">
                            <option value="">–í—Å–µ</option>
                            <option value="–ù–æ–≤—ã–π">–ù–æ–≤—ã–π</option>
                            <option value="–û–∂–∏–¥–∞–µ—Ç –æ—Ç–≤–µ—Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞">–û–∂–∏–¥–∞–µ—Ç –æ—Ç–≤–µ—Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞</option>
                            <option value="–û–∂–∏–¥–∞–µ—Ç –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞">–û–∂–∏–¥–∞–µ—Ç –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞</option>
                            <option value="–ó–∞–∫—Ä—ã—Ç">–ó–∞–∫—Ä—ã—Ç</option>
                            <option value="–ó–∞–∫—Ä—ã—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏">–ó–∞–∫—Ä—ã—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-secondary" id="dialogFiltersReset">–°–±—Ä–æ—Å–∏—Ç—å</button>
                <button type="button" class="btn btn-primary" id="dialogFiltersApply">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="dialogColumnsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–ö–æ–ª–æ–Ω–∫–∏</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
            </div>
            <div class="modal-body">
                <div class="row g-2" id="dialogColumnsList"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-secondary" id="dialogColumnsReset">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
                <button type="button" class="btn btn-primary" id="dialogColumnsApply">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade resizable-modal" id="dialogDetailsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <div class="dialog-details-header">
                    <div class="dialog-details-avatar" id="dialogDetailsAvatar" aria-hidden="true">
                        <img class="dialog-details-avatar-img d-none" alt="–ê–≤–∞—Ç–∞—Ä –∫–ª–∏–µ–Ω—Ç–∞" data-avatar-img>
                        <span class="dialog-details-avatar-initial" data-avatar-initial>‚Äî</span>
                    </div>
                    <div>
                        <h5 class="modal-title mb-1">–î–µ—Ç–∞–ª–∏ –¥–∏–∞–ª–æ–≥–∞</h5>
                        <div class="text-muted small d-flex flex-wrap gap-2">
                            <span id="dialogDetailsMeta"></span>
                            <span class="text-warning d-none" id="dialogDetailsRating"></span>
                            <span class="badge text-bg-danger d-none" id="dialogDetailsUnreadCount"></span>
                        </div>
                        <div class="small text-muted dialog-details-categories" id="dialogDetailsCategories">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏: ‚Äî</div>
                        <div class="small">
                            <span class="fw-semibold" id="dialogDetailsClientName">‚Äî</span>
                            <span class="text-muted" id="dialogDetailsClientStatus">‚Äî</span>
                        </div>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
            </div>
            <div class="modal-body">
                <div class="dialog-details-layout">
                    <div class="dialog-details-sidebar" id="dialogDetailsSidebar">
                        <div class="dialog-details-section">
                            <div class="fw-semibold mb-2">–°–≤–æ–¥–∫–∞</div>
                            <div class="d-flex flex-column gap-1" id="dialogDetailsSummary"></div>
                        </div>
                        <div class="dialog-details-section">
                            <div class="fw-semibold mb-2">–ü—Ä–æ–±–ª–µ–º–∞</div>
                            <div class="dialog-details-problem" id="dialogDetailsProblem">‚Äî</div>
                        </div>
                        <div class="dialog-details-section">
                            <div class="fw-semibold mb-2">–ú–µ—Ç—Ä–∏–∫–∏</div>
                            <div class="d-flex flex-column gap-2 small" id="dialogDetailsMetrics"></div>
                        </div>
                        <div class="dialog-details-section dialog-templates-dropdown" id="dialogCompletionTemplatesSection">
                            <button class="dialog-templates-toggle" type="button" id="dialogCompletionTemplatesToggle">
                                –®–∞–±–ª–æ–Ω—ã –¥–µ–π—Å—Ç–≤–∏–π
                                <span class="dialog-templates-caret" aria-hidden="true">‚ñæ</span>
                            </button>
                            <div class="dialog-templates-menu" id="dialogCompletionTemplatesMenu">
                                <div class="d-flex align-items-center justify-content-between mb-2">
                                    <div class="fw-semibold small">–ù–∞–±–æ—Ä —à–∞–±–ª–æ–Ω–æ–≤</div>
                                    <select class="form-select form-select-sm w-auto" id="dialogCompletionTemplateSelect"></select>
                                </div>
                                <div class="d-flex flex-column gap-2 small" id="dialogCompletionTemplateList"></div>
                                <div class="text-muted small d-none" id="dialogCompletionTemplateEmpty">–®–∞–±–ª–æ–Ω—ã –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã.</div>
                            </div>
                        </div>
                        <div class="dialog-details-resize-handle" id="dialogDetailsResizeHandle" aria-hidden="true"></div>
                    </div>
                    <div class="dialog-details-main">
                        <div class="card shadow-sm border-0 h-100">
                            <div class="card-body d-flex flex-column">
                                <div class="d-flex align-items-center justify-content-between gap-2 mb-2">
                                    <div class="fw-semibold">–ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                                    <label class="dialog-font-control small text-muted">
                                        –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞
                                        <input type="range" class="form-range" id="dialogFontSizeRange" min="12" max="18" step="1" value="14">
                                    </label>
                                </div>
                                <div class="d-flex flex-column gap-2 chat-history flex-grow-1" id="dialogDetailsHistory"></div>
                                <div class="dialog-details-composer mt-3">
                                    <label class="form-label small text-muted" for="dialogReplyText">–û—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É</label>
                                    <div class="dialog-composer-panels">
                                        <div class="dialog-template-panel" id="dialogEmojiPanel">
                                            <div class="fw-semibold small mb-2">–≠–º–æ–¥–∑–∏</div>
                                            <div class="d-flex flex-wrap gap-2" id="dialogEmojiList"></div>
                                        </div>
                                        <div class="dialog-template-panel" id="dialogQuestionTemplatesSection">
                                            <div class="d-flex align-items-center justify-content-between mb-2">
                                                <div class="fw-semibold small">–®–∞–±–ª–æ–Ω—ã –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                                                <select class="form-select form-select-sm w-auto" id="dialogQuestionTemplateSelect"></select>
                                            </div>
                                            <div class="d-flex flex-column gap-2" id="dialogQuestionTemplateList"></div>
                                            <div class="text-muted small d-none" id="dialogQuestionTemplateEmpty">–®–∞–±–ª–æ–Ω—ã –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã.</div>
                                        </div>
                                    </div>
                                    <div class="dialog-composer-input mt-2">
                                        <div class="dialog-composer-textarea">
                                            <textarea class="form-control" id="dialogReplyText" rows="2" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç..."></textarea>
                                            <div class="dialog-composer-overlay">
                                                <button class="dialog-template-icon" type="button" data-template-toggle="question"
                                                        aria-label="–®–∞–±–ª–æ–Ω—ã –≤–æ–ø—Ä–æ—Å–æ–≤" data-tooltip="–®–∞–±–ª–æ–Ω—ã –≤–æ–ø—Ä–æ—Å–æ–≤">
                                                    ‚ùì
                                                </button>
                                                <button class="dialog-template-icon" type="button" id="dialogReplyEmojiTrigger"
                                                        aria-label="–î–æ–±–∞–≤–∏—Ç—å —ç–º–æ–¥–∑–∏" data-tooltip="–î–æ–±–∞–≤–∏—Ç—å —ç–º–æ–¥–∑–∏">
                                                    üòÄ
                                                </button>
                                                <button class="dialog-template-icon" type="button" id="dialogReplyMediaTrigger"
                                                        aria-label="–î–æ–±–∞–≤–∏—Ç—å –º–µ–¥–∏–∞" data-tooltip="–î–æ–±–∞–≤–∏—Ç—å –º–µ–¥–∏–∞">
                                                    üìé
                                                </button>
                                            </div>
                                        </div>
                                        <button class="btn btn-primary" type="button" id="dialogReplySend">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                                        <input class="d-none" type="file" id="dialogReplyMedia" multiple>
                                    </div>
                                    <div class="dialog-reply-target d-none" id="dialogReplyTarget">
                                        <div class="small text-muted">–û—Ç–≤–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ:</div>
                                        <div class="dialog-reply-target-text" id="dialogReplyTargetText"></div>
                                        <button class="btn btn-sm btn-link p-0" type="button" id="dialogReplyTargetClear">–°–±—Ä–æ—Å–∏—Ç—å</button>
                                    </div>
                                    <div class="form-text">–°–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∞–∫—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥ –∫–ª–∏–µ–Ω—Ç–∞.</div>
                                </div>
                                <div class="dialog-details-section mt-3">
                                    <div class="d-flex align-items-center justify-content-between gap-2 mb-2">
                                        <div class="fw-semibold">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è</div>
                                        <button class="btn btn-outline-secondary btn-sm" type="button" data-template-toggle="category">
                                            –í—ã–±—Ä–∞—Ç—å
                                        </button>
                                    </div>
                                    <div class="dialog-template-panel is-open" id="dialogCategoryTemplatesSection">
                                        <div class="d-flex align-items-center justify-content-between mb-2">
                                            <div class="fw-semibold small">–ù–∞–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π</div>
                                            <select class="form-select form-select-sm w-auto" id="dialogCategoryTemplateSelect"></select>
                                        </div>
                                        <div class="d-flex flex-wrap gap-2 small" id="dialogCategoryTemplateList"></div>
                                        <div class="text-muted small d-none" id="dialogCategoryTemplateEmpty">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã.</div>
                                        <div class="form-text small mt-2">–í—ã–±–æ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a class="btn btn-outline-secondary" id="dialogDetailsCreateTask" th:href="@{/tasks}">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</a>
                <button type="button" class="btn btn-outline-success" id="dialogDetailsResolve">–ó–∞–∫—Ä—ã—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ</button>
                <button type="button" class="btn btn-outline-warning d-none" id="dialogDetailsReopen">–ü–µ—Ä–µ–æ—Ç–∫—Ä—ã—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ</button>
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="dialogMediaPreviewModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ–¥–∏–∞</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
            </div>
            <div class="modal-body">
                <video class="w-100 d-none" id="dialogMediaPreviewVideo" controls></video>
                <img class="w-100 d-none dialog-media-preview-image" id="dialogMediaPreviewImage" alt="–ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
            </div>
            <div class="modal-footer">
                <div class="btn-group d-none" id="dialogMediaImageControls" role="group" aria-label="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º">
                    <button class="btn btn-outline-secondary" type="button" id="dialogMediaZoomOut">–£–º–µ–Ω—å—à–∏—Ç—å</button>
                    <button class="btn btn-outline-secondary" type="button" id="dialogMediaZoomIn">–£–≤–µ–ª–∏—á–∏—Ç—å</button>
                </div>
                <a class="btn btn-outline-primary d-none" href="#" id="dialogMediaDownloadLink" download target="_blank" rel="noopener">–°–∫–∞—á–∞—Ç—å</a>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script th:inline="javascript">
  const RAW_DIALOG_CONFIG = /*[[${settingsPayload['dialog_config']}]]*/ {};
  window.DIALOG_CONFIG = RAW_DIALOG_CONFIG && typeof RAW_DIALOG_CONFIG === 'object' ? RAW_DIALOG_CONFIG : {};
  const RAW_BUSINESS_CELL_STYLES = /*[[${settingsPayload['business_cell_styles']}]]*/ {};
  window.BUSINESS_CELL_STYLES = RAW_BUSINESS_CELL_STYLES && typeof RAW_BUSINESS_CELL_STYLES === 'object'
    ? RAW_BUSINESS_CELL_STYLES
    : {};
</script>
<script th:src="@{/js/dialogs.js}"></script>
</body>
</html>
