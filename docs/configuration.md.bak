# ⚙️ Конфигурация

`config.Settings` объединяет переменные окружения, `.env` в корне репозитория и JSON-файлы из `config/shared`. Все сервисы (боты, веб-панель, миграции) получают доступ к настройкам только через этот класс, что гарантирует единое поведение.

## .env и переменные окружения

Создайте файл `.env` по примеру ниже и дополните его нужными переменными окружения:

```
TELEGRAM_BOT_TOKEN=123:ABC
GROUP_CHAT_ID=-1001234567890
SECRET_KEY=change-me
DATABASE_URL=sqlite:///./tickets.db
```

Класс `Settings` использует [Dynaconf](https://www.dynaconf.com/) для чтения `.env` и значений из окружения. Основные переменные:

- `TELEGRAM_BOT_TOKEN` — токен бота, обязателен;
- `GROUP_CHAT_ID` — ID группы для уведомлений (число);
- `SECRET_KEY` — ключ сессий Flask (по умолчанию `dev-secret-key`);
- `DATABASE_URL` — необязательная строка подключения SQLAlchemy. Если не задана, используется SQLite `tickets.db`;
- `APP_DB_TICKETS`, `APP_DB_USERS`, `APP_DB_OBJECT_PASSPORTS`, `APP_DB_BOT` — пути к SQLite-файлам для различных сервисов;
- `APP_STORAGE_ATTACHMENTS`, `APP_STORAGE_KNOWLEDGE_BASE`, `APP_STORAGE_AVATARS`, `APP_STORAGE_AVATAR_HISTORY`, `APP_STORAGE_OBJECT_PASSPORTS`, `APP_STORAGE_USER_PHOTOS` — каталоги хранения. Если переменные не заданы, используются пути внутри репозитория.

Все каталоги из блока `storage` создаются автоматически при инициализации `Settings`, что упрощает первый запуск на чистом сервере.

## Общие JSON-настройки

Файлы `config/shared/settings.json`, `config/shared/locations.json` и `config/shared/org_structure.json` используются одновременно Python- и Java-частями проекта. `Settings` предоставляет пути к ним и вспомогательную функцию `config.load_shared_settings()` для чтения `settings.json` с повторной валидацией.

При изменении JSON-файлов перезапуск сервисов не требуется — они читаются напрямую с диска.